---
layout: post
title: "Числа Фибоначчи - 3 способа нахождения"
description: "Числа Фибоначчи. Нахождение чисел Фибоначчи через рекурсию, формулу Бине и через итерацию(массив)"
author: "Paul Finch"
categories: javascript
tags: [ES6, Algorithm, Computer Science]
image: fibonacci.jpg
---

Числа Фибоначчи  — это числовая последовательность где каждое следующее число, равно сумме 2 предидущих. Алгоритм их нахождения зачастую можно найти в учебниках по программированию, как пример [рекурсии](https://habr.com/post/337030/). Спрашивают это и на собеседованиях, чтобы проверить у Вас знание простых алгоритмов. Давайте напишем 3 метода нахождения числового ряда Фибоначии, и сравним скорость их выполнения.

<!--excerpt-->
<br />
### Формула нахождения.

Сначала приведем пример числового ряда - __*0, 1, 1, 2, 3, 5, 8, 13, 21…*__ и так до бесконечности, Чтобы найти любое число последовательности, существует формула:
> F<sub>0</sub> = 0; F<sub>1</sub> = 1; F<sub>n</sub> = F<sub>n-1</sub> + F<sub>n+2</sub>;

Первый элемент равен нулю, второй равен еденице, третий элемент равен сумме 0 + 1 и так далее... 

<br/>
### Метод 1: Рекурсия

Сначала, для того чтобы измерить длительность выполнения прибегнем к консоли, и в частности к ее методам: console.time(timerName) и console.timeEnd(timerName), где __*timerName*__ - название(метка) таймера. Первый начинает отсчет, второй останавливает таймер. Измерятеся время в миллисекундах(*ms*).
```javascript
// начинаем отсчет
console.time('Test Fibonacci')

// здесь пишем что будем делать

// останавливаем подсчет
console.timeEnd('Test Fibonacci')
```
Напишем метод нахождения заданного числа последователности. Главный минус тут заключается в том, что рекурсия достаточно ресурсоемкая операция. 

```javascript
function fib(n) {
    let num;

    if (n >= 2) {
        num = fib(n - 1) + fib(n - 2);
    } else {
        num = n
    }

    return num;
}
```
<br/>
### Метод2: Перебор(итерация)

Второй способ выберем попроще - масивами. Можно конечно обойтись и без них, но так будет понятнее, ведь Числа Фибоначии это обычный числовой массив в JavaScript, работать с которым
умеют даже начинащие разработчики. К тому же, можно вторым аргументом задать *callback*, который будет делать с этим массивом все что угодно - фильтровать, обрезать и т.д. 
```javascript
function fibArray(n) {
    
    // массив с будующими числами
    // fb[0] - первый индекс, fb[1] - второй индекс
    let fb    = [],
        fb[0] = 0;
        fb[1] = 1;
    
    // строим последовательность
    for (let i = 2; i <= n; i++) {
        fb[i] = fb[i - 1] + fb[i - 2];
    }

    // возвращаем искомый элемент
    return fb[n];
}
```
<br/>
### Метод 3: Формула Бине.

Собственно данный способ я нашел в [Википедии](https://ru.wikipedia.org/wiki/%D0%A7%D0%B8%D1%81%D0%BB%D0%B0_%D0%A4%D0%B8%D0%B1%D0%BE%D0%BD%D0%B0%D1%87%D1%87%D0%B8): 
> ![Описание картинки с котиком](https://wikimedia.org/api/rest_v1/media/math/render/svg/7e13a8a7c316c95f60118e8a3dc9641eb1680dc2)

Здесь нас интересует дробь до первого знака равенства. Напишем метод.
```javascript
function fibBine(n) {
    
    // сохраняем значение корня
    let sq5 = Math.sqrt(5); 
    let a = (1 + sq5) / 2;
    let b = (1 - sq5) / 2;

    // Math.ceil() - дает целое число, округляет дробь в большую сторону.
    return Math.ceil((Math.pow(a, n) - Math.pow(b, n)) / sq5);
}
```

<br/>
### Тестирование

Мы написали 3 метода, теперь давайте сравним результаты. Заранее ясно, что рекурсия будет медленее, но вот насколько... Для более наглядного результата найдем последовательность до 45 знака. Браузером у нас будет Google Chrome последней версии.
```javascript
console.time("Iteration");
console.log(`Перебор - ${fibArray(45)}`)
console.timeEnd("Iteration");

console.time("Recursion");
console.log(`Рекурсия - ${fib(45)}`)
console.timeEnd("Recursion");

console.time("Bine");
console.log(`Формула Бине - ${fibBine(45)}`)
console.timeEnd("Bine");
```
Получаем слудующие результаты:
- Iteration: __0.999755859375ms__
- Recursion: __12513ms__
- Bine: __0ms__

Как видим, на втором шаге барзуер серьезно "задумывается", так как рекурсия достаточно затратная по ресурсам операция. Не стоит ее применять бездумно. Что касается методов перебора и формулы Бине, то первый немного медленее(*иногда результаты получались равными*), но более функциональнее. Разница меж ними невелика, особенно если сравнить с рекурсией. Для проверки можно найти последовательность Фибоначии до 300 или 500 знака.

Существует еще однин спобсоб вычисления - матрицами. Вы можете его реализовать сами. Алгоритм и формулу можно посмотреть [здесь](https://ru.wikibooks.org/wiki/%D0%92%D1%8B%D1%87%D0%B8%D1%81%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D1%87%D0%B8%D1%81%D0%B5%D0%BB_%D0%A4%D0%B8%D0%B1%D0%BE%D0%BD%D0%B0%D1%87%D1%87%D0%B8#%D0%A0%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5_%D0%B1%D1%8B%D1%81%D1%82%D1%80%D1%8B%D0%BC_%D0%B2%D0%BE%D0%B7%D0%B2%D0%B5%D0%B4%D0%B5%D0%BD%D0%B8%D0%B5%D0%BC_%D0%BC%D0%B0%D1%82%D1%80%D0%B8%D1%86%D1%8B_%D0%B2_%D1%81%D1%82%D0%B5%D0%BF%D0%B5%D0%BD%D1%8C)