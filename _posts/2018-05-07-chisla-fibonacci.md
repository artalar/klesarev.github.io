---
layout: post
title: "Числа Фибоначчи - простые способы нахождения"
description: "Числа Фибоначчи. Нахождение чисел Фибоначчи через рекурсию, формулу Бине и через итерацию(массив)"
author: "Paul Finch"
categories: javascript
tags: [ES6, Algorithm, Computer Science]
image: fibonacci.jpg
---

Числа Фибоначчи  — это числовая последовательность где каждое следующее число, равно сумме 2 предидущих. Алгоритм их нахождения часто можно найти в учебниках по программированию. 
Довольно часто можно встретить метод нахождения этого числового ряда рекурсией. Давайте добавим сюда еще 2 способа и сравним их производительность.

<!--excerpt-->
<br />
### Формула нахождения.

Чтобы понять о чем речь, приведем пример числового ряда - __*0, 1, 1, 2, 3, 5, 8, 13, 21…*__ и так до бесконечности. Чтобы найти любое число последовательности, существует формула:
> F<sub>0</sub> = 0; F<sub>1</sub> = 1; F<sub>n</sub> = F<sub>n-1</sub> + F<sub>n+2</sub>;
Первый элемент равен нулю, второй равен еденице, третий элемент равен сумме 0 + 1 и так далее. 

<br/>
### Реализация с помощью рекурсии

Для того чтобы измерить длительность выполнения прибегнем к консоли, и в частности к ее методам: console.time(timerName) и console.timeEnd(timerName), где timerName - название таймера. Первый начинает отсчет, второй останавливает таймер. Измерятеся время в *ms*.
```javascript
// начинаем отсчет
console.time('Test Fibonacci')

// здесь пишем что будем делать

// останавливаем подсчет
console.timeEnd('Test Fibonacci')
```
Напишем рекурсивынй метод нахождения заданного числа последователности. Главный минус тут заключается в том, что рекурсия достаточно ресурсоемкая операция. 

```javascript
function fib(n) {
    let num;

    if (n >= 2) {
        num = fib(n - 1) + fib(n - 2);
    } else {
        num = n
    }

    return num;
}
```
<br/>
### Реализация с помощью итерации

Второй способ выберем попроще - масивами. Можно конечно обойтись и без них, но так будет понятнее, ведь Числа Фибоначии это обычный числовой массив в JavaScript, работать с которым
умеют даже начинащие разработчики. К тому же, можно вторым аргументом задать *callback*, который будет делать с этим массивом все что угодно - фильтровать, обрезать и т.д. 
```javascript
function fibArray(n) {
    
    // массив с будующими числами
    // fb[0] - первый индекс, fb[1] - второй индекс
    let fb    = [],
        fb[0] = 0;
        fb[1] = 1;
    
    // строим последовательность
    for (let i = 2; i <= n; i++) {
        fb[i] = fb[i - 1] + fb[i - 2];
    }

    // возвращаем искомый элемент
    return fb[n];
}
```
<br/>
### Реализация с помощью формулы Бине

Собственно данный способ я нашел в [Википедии](https://ru.wikipedia.org/wiki/%D0%A7%D0%B8%D1%81%D0%BB%D0%B0_%D0%A4%D0%B8%D0%B1%D0%BE%D0%BD%D0%B0%D1%87%D1%87%D0%B8): 
> ![Описание картинки с котиком](https://wikimedia.org/api/rest_v1/media/math/render/svg/7e13a8a7c316c95f60118e8a3dc9641eb1680dc2)

Здесь нас интересует дробь до первого знака равенства. Напишем метод.
```javascript
function fibBine(n) {
    
    // сохраняем значение корня
    let sq5 = Math.sqrt(5); 
    let a = (1 + sq5) / 2;
    let b = (1 - sq5) / 2;

    // Math.ceil() - дает целое число, округляет дробь в большую сторону.
    return Math.ceil((Math.pow(a, n) - Math.pow(b, n)) / sq5);
}
```

<br/>
### Тестирование

Мы написали 3 метода, теперь давайте сравним результаты. Заранее ясно, что рекурсия будет медленее, но вот насколько. Найдем последовательность до 45 знака. Браузером у нас будет Google Chrome последней версии.
```javascript
console.time("Iteration");
console.log(`Перебор - ${fibArray(45)}`)
console.timeEnd("Iteration");

console.time("Recursion");
console.log(`Рекурсия - ${fib(45)}`)
console.timeEnd("Recursion");

console.time("Bine");
console.log(`Формула Бине - ${fibBine(45)}`)
console.timeEnd("Bine");
```
Получаем слудующие результаты:
- Iteration: __0.999755859375ms__
- Recursion: __12513ms__
- Bine: __0ms__

Как видим, на втором шаге барзуер серьезно "задумывается", так как рекурсия достаточно затратная по ресурсам операция. Не стоит ее применять бездумно. Что касается методов перебора и формулы Бине, то первый немного медленее, но более функциональнее. Разница меж ними невелика, особенно если сравнить с рекурсией. Для проверки можно найти последовательность Фибоначии до 300 или 500 знака.